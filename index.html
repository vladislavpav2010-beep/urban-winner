<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TON PvP</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">

<style>
:root{
--bg:#070707;
--card:#111;
--accent:#ff8c00;
--accent2:#ffb347;
--border:#222;
--text:#fff;
--muted:#777;
}

*{box-sizing:border-box;font-family:Inter}
body{
margin:0;
background:var(--bg);
color:var(--text);
height:100vh;
display:flex;
flex-direction:column;
}

/* HEADER */
.header{
padding:15px 20px;
display:flex;
justify-content:space-between;
align-items:center;
border-bottom:1px solid var(--border);
background:#000;
}
.balance{
background:linear-gradient(135deg,#ff8c00,#ffb347);
padding:8px 14px;
border-radius:14px;
font-weight:900;
color:#000;
}

/* PAGES */
.page{flex:1;display:none;overflow-y:auto;padding-bottom:90px}
.page.active{display:block}

/* WHEEL */
.wheel-zone{
width:300px;
height:300px;
margin:20px auto;
position:relative;
}
#wheelWrap{
width:100%;
height:100%;
border-radius:50%;
transition:transform 8s cubic-bezier(.1,0,.1,1);
box-shadow:0 0 40px rgba(255,140,0,.25);
}
canvas{width:100%;height:100%}
.center{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
width:90px;
height:90px;
border-radius:50%;
background:#000;
border:2px solid var(--border);
display:flex;
align-items:center;
justify-content:center;
font-weight:900;
font-size:22px;
color:var(--accent);
}

/* BET */
.bet-box{
margin:15px;
background:var(--card);
border-radius:18px;
padding:15px;
display:flex;
gap:10px;
border:1px solid var(--border);
}
.bet-box input{
flex:1;
background:#000;
border:1px solid var(--border);
border-radius:12px;
padding:12px;
color:#fff;
font-weight:700;
}
.bet-box button{
background:linear-gradient(135deg,#ff8c00,#ffb347);
border:none;
border-radius:12px;
font-weight:900;
padding:0 20px;
}

/* PLAYERS */
.players{padding:0 15px}
.player{
display:flex;
justify-content:space-between;
background:var(--card);
border-radius:12px;
padding:10px 14px;
margin-bottom:6px;
border:1px solid var(--border);
}

/* PROFILE */
.card{
margin:15px;
background:var(--card);
border-radius:20px;
padding:18px;
border:1px solid var(--border);
}
.stat{
display:flex;
justify-content:space-between;
margin:6px 0;
color:var(--muted);
}
.stat b{color:#fff}

/* REF */
.refbox{
margin-top:10px;
border:1px dashed var(--accent);
padding:12px;
border-radius:12px;
text-align:center;
color:var(--accent);
font-weight:700;
}

/* HISTORY */
.history{
padding:15px;
}
.hist{
background:var(--card);
border-radius:14px;
padding:12px;
margin-bottom:6px;
border:1px solid var(--border);
display:flex;
justify-content:space-between;
}

/* NAV */
.nav{
position:fixed;
bottom:0;
width:100%;
height:75px;
background:#000;
border-top:1px solid var(--border);
display:flex;
}
.nav div{
flex:1;
display:flex;
flex-direction:column;
align-items:center;
justify-content:center;
font-size:11px;
color:var(--muted);
font-weight:800;
}
.nav .active{color:var(--accent)}
</style>
</head>

<body>

<div class="header">
<div style="font-weight:900">TON<span style="color:var(--accent)">PVP</span></div>
<div class="balance"><span id="bal">1000.00</span> TON</div>
</div>

<!-- GAME -->
<div id="game" class="page active">
<div class="wheel-zone">
<div id="wheelWrap">
<canvas id="wheel" width="800" height="800"></canvas>
</div>
<div class="center" id="timer">15</div>
</div>

<div class="bet-box">
<input id="bet" type="number" value="10">
<button onclick="makeBet()">СТАВКА</button>
</div>

<div class="players" id="players"></div>
</div>

<!-- PROFILE -->
<div id="profile" class="page">
<div class="card">
<b style="color:var(--accent)">ПРОФИЛЬ</b>
<div class="stat"><span>ID</span><b id="uid"></b></div>
<div class="stat"><span>Баланс</span><b><span id="pbal"></span> TON</b></div>
</div>

<div class="card">
<b style="color:var(--accent)">РЕФЕРАЛЬНАЯ СИСТЕМА</b>
<p style="font-size:13px;color:var(--muted)">Ты получаешь <b>10%</b> от каждого депозита друга</p>
<div class="refbox">t.me/tonpvp_bot?start=r_<span id="uid2"></span></div>
<button style="width:100%;margin-top:10px" onclick="fakeRef()">Симулировать депозит реферала</button>
<div class="stat"><span>Приглашено</span><b id="refs">0</b></div>
<div class="stat"><span>Оборот</span><b id="turn">0 TON</b></div>
<div class="stat"><span>Доход</span><b id="earn">0 TON</b></div>
</div>
</div>

<!-- HISTORY -->
<div id="history" class="page">
<div class="history" id="hist"></div>
</div>

<!-- NAV -->
<div class="nav">
<div class="active" onclick="openPage('game',this)">PVP</div>
<div onclick="openChat()">ЧАТ</div>
<div onclick="openPage('history',this)">ИСТОРИЯ</div>
<div onclick="openPage('profile',this)">ПРОФИЛЬ</div>
</div>

<script>
let user={
bal:+localStorage.bal||1000,
id:localStorage.id||Math.floor(Math.random()*90000+10000),
refs:+localStorage.refs||0,
earn:+localStorage.earn||0,
turn:+localStorage.turn||0,
hist:JSON.parse(localStorage.hist||'[]')
};

let players=[],time=15,spin=false,rot=0;
const bots=['@rich','@tonny','@crypto','@whale'];
const colors=['#ff8c00','#ffb347','#fff','#333'];

const c=document.getElementById('wheel');
const ctx=c.getContext('2d');

function save(){
localStorage.bal=user.bal;
localStorage.id=user.id;
localStorage.refs=user.refs;
localStorage.earn=user.earn;
localStorage.turn=user.turn;
localStorage.hist=JSON.stringify(user.hist);
update();
}

function update(){
bal.textContent=user.bal.toFixed(2);
pbal.textContent=user.bal.toFixed(2);
uid.textContent=user.id;
uid2.textContent=user.id;
refs.textContent=user.refs;
earn.textContent=user.earn.toFixed(2)+' TON';
turn.textContent=user.turn.toFixed(2)+' TON';

playersBox.innerHTML=players.map(p=>`
<div class="player"><b>${p.name}</b><span>${p.bet} TON</span></div>`).join('');

hist.innerHTML=user.hist.map(h=>`
<div class="hist"><b>${h.w}</b><span>${h.b} TON</span></div>`).join('');
}

function draw(){
ctx.clearRect(0,0,800,800);
if(!players.length)return;
let total=players.reduce((s,p)=>s+p.bet,0),a=0;
players.forEach((p,i)=>{
let s=p.bet/total*Math.PI*2;
p.mid=a+s/2;
ctx.beginPath();
ctx.moveTo(400,400);
ctx.arc(400,400,400,a,a+s);
ctx.fillStyle=colors[i%colors.length];
ctx.fill();
a+=s;
});
}

function loop(){
players=[];time=15;spin=false;
wheelWrap.style.transition='none';
tick();
}

function tick(){
let t=setInterval(()=>{
timer.textContent=time;
if(time%3===0&&players.length<5){
players.push({name:bots[Math.random()*bots.length|0],bet:Math.random()*60+20|0});
draw();update();
}
if(--time<=0){
clearInterval(t);
players.length>1?spinWheel():loop();
}
},1000);
}

function spinWheel(){
spin=true;
let total=players.reduce((s,p)=>s+p.bet,0);
let r=Math.random()*total,a=0,w;
for(let p of players){a+=p.bet;if(r<=a){w=p;break}}
rot+=360*8+(360-(w.mid*180/Math.PI));
wheelWrap.style.transition='transform 8s cubic-bezier(.1,0,.1,1)';
wheelWrap.style.transform=`rotate(${rot}deg)`;
setTimeout(()=>{
if(w.me)user.bal+=total;
user.hist.unshift({w:w.name,b:total});
if(user.hist.length>20)user.hist.pop();
save();loop();
},8500);
}

function makeBet(){
let v=+bet.value;
if(spin||v<=0||v>user.bal)return;
user.bal-=v;
players.push({name:'@ВЫ',bet:v,me:true});
draw();save();
}

function fakeRef(){
let dep=Math.random()*400+100|0;
let bonus=dep*0.1;
user.refs++;
user.turn+=dep;
user.earn+=bonus;
user.bal+=bonus;
alert(`Реферал пополнил ${dep} TON\nТвой доход +${bonus.toFixed(2)} TON`);
save();
}

function openPage(id,el){
document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
document.querySelectorAll('.nav div').forEach(n=>n.classList.remove('active'));
document.getElementById(id).classList.add('active');
el.classList.add('active');
}

function openChat(){
window.open('https://t.me/+bRdL2okzUTdiZDVi','_blank');
}

const playersBox=document.getElementById('players');
save();loop();
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CircleGift PvP TON</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        :root {
            --bg: #0f0f13; --card: #1c1c24; --accent: #ffc107;
            --p1: #3600ff; --p2: #d9006c; --p3: #b05cff; --p4: #9d4edd; --me: #0098ea;
        }
        * { box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); color: #fff; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        .header { padding: 15px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .banner { width: 100%; background: linear-gradient(90deg, #d9006c, #8a2be2); padding: 12px; border-radius: 12px; text-align: center; font-weight: 900; text-transform: uppercase; font-size: 14px; }
        .pool-info { background: #23232d; padding: 6px 20px; border-radius: 20px; font-weight: 800; color: #eee; font-size: 13px; }

        /* Wheel Physics */
        .wheel-box { position: relative; width: 320px; height: 320px; margin: 10px auto; }
        .arrow { position: absolute; top: -12px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 25px solid #fff; z-index: 10; filter: drop-shadow(0 2px 5px #000); }
        .wheel-wrap { width: 100%; height: 100%; border-radius: 50%; transition: transform 7s cubic-bezier(0.15, 0, 0.15, 1); will-change: transform; }
        canvas { width: 100%; height: 100%; display: block; }
        
        .center { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 110px; height: 110px; background: var(--bg); border-radius: 50%; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 5; box-shadow: inset 0 0 15px #000; }
        #timer { font-size: 32px; font-weight: 900; }
        #status-text { font-size: 10px; font-weight: 800; color: #555; text-transform: uppercase; margin-top: -5px; }

        .controls { padding: 15px; display: flex; gap: 10px; }
        .btn { flex: 1; padding: 16px; border-radius: 16px; border: none; font-weight: 900; font-size: 15px; cursor: pointer; transition: 0.2s; }
        .btn-add { background: var(--accent); color: #000; }
        .btn-bet { background: #2a2a35; color: #fff; border: 1px solid #333; }
        .btn:active { transform: scale(0.95); opacity: 0.8; }

        .list-title { padding: 0 20px; font-weight: 900; font-size: 17px; margin-bottom: 10px; display: flex; justify-content: space-between; }
        .player-list { flex: 1; overflow-y: auto; padding: 0 15px 20px; display: flex; flex-direction: column; gap: 8px; }
        .item { display: flex; align-items: center; background: var(--card); padding: 12px; border-radius: 15px; border: 1px solid #25252e; }
        .av { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 900; color: #fff; margin-right: 12px; border: 2px solid rgba(255,255,255,0.1); }
        .info { flex: 1; }
        .name { font-weight: 700; font-size: 14px; }
        .sub { font-size: 11px; color: #777; }
        .perc { text-align: right; font-weight: 900; font-size: 15px; }
        .val { font-size: 11px; color: #777; }
    </style>
</head>
<body>

<div class="header">
    <div class="banner">üå∏ –°–∞–∫—É—Ä–∞ PvP —Ç—É—Ä–Ω–∏—Ä üå∏</div>
    <div class="pool-info">–í–°–ï–ì–û <span id="pool-total">0.00</span> TON</div>
</div>

<div class="wheel-box">
    <div class="arrow"></div>
    <div class="wheel-wrap" id="wheel">
        <canvas id="canvas" width="600" height="600"></canvas>
    </div>
    <div class="center">
        <div id="timer">00:05</div>
        <div id="status-text">–î–û –ù–ê–ß–ê–õ–ê</div>
    </div>
</div>

<div class="controls">
    <button class="btn btn-add" onclick="startTimer()">+ –¢–ï–°–¢ –°–ü–ò–ù</button>
    <button class="btn btn-bet" onclick="addMyBet()">üíé 4.1 TON</button>
</div>

<div class="list-title">
    <span id="p-count">0 –ò–≥—Ä–æ–∫–æ–≤</span>
    <span style="color:var(--accent); font-size: 12px;">–¢–≤–æ–π –±–∞–ª–∞–Ω—Å: <span id="my-bal">10.00</span> TON</span>
</div>

<div class="player-list" id="list"></div>

<script>
    let myBalance = 10.00;
    let players = [
        { name: '@essieem', bet: 36.48, color: '#3600ff' },
        { name: '@sonya', bet: 4.23, color: '#d9006c' },
        { name: '@tripochek', bet: 1.00, color: '#b05cff' },
        { name: '@yuccca1', bet: 0.83, color: '#9d4edd' }
    ];

    let isSpinning = false;
    let currentRotation = 0;
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    function update() {
        const total = players.reduce((s, p) => s + p.bet, 0);
        document.getElementById('pool-total').textContent = total.toFixed(2);
        document.getElementById('p-count').textContent = players.length + ' –ò–≥—Ä–æ–∫–æ–≤';
        document.getElementById('my-bal').textContent = myBalance.toFixed(2);

        let start = 0;
        players.forEach(p => {
            p.chance = (p.bet / total);
            p.startAngle = start;
            p.endAngle = start + (p.chance * Math.PI * 2);
            start = p.endAngle;
        });

        draw();
        renderList();
    }

    function draw() {
        const r = canvas.width / 2;
        ctx.clearRect(0,0,600,600);
        ctx.save();
        ctx.translate(r, r);
        ctx.rotate(-Math.PI/2);

        players.forEach(p => {
            ctx.beginPath();
            ctx.moveTo(0,0);
            ctx.arc(0,0, r, p.startAngle, p.endAngle);
            ctx.fillStyle = p.color;
            ctx.fill();
            ctx.strokeStyle = '#0f0f13';
            ctx.lineWidth = 4;
            ctx.stroke();

            // Avatar on wheel
            ctx.save();
            const ang = p.startAngle + (p.endAngle - p.startAngle)/2;
            ctx.rotate(ang);
            ctx.translate(r * 0.7, 0);
            ctx.rotate(Math.PI/2 - ang);
            
            ctx.beginPath();
            ctx.arc(0,0, 25, 0, Math.PI*2);
            ctx.fillStyle = '#fff';
            ctx.fill();
            ctx.fillStyle = '#000';
            ctx.font = 'bold 24px Inter';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(p.name[1].toUpperCase(), 0, 2);
            ctx.restore();
        });
        ctx.restore();
    }

    function renderList() {
        const container = document.getElementById('list');
        container.innerHTML = players.sort((a,b)=>b.bet-a.bet).map(p => `
            <div class="item">
                <div class="av" style="background:${p.color}">${p.name[1].toUpperCase()}</div>
                <div class="info">
                    <div class="name">${p.name}</div>
                    <div class="sub">–ò–≥—Ä–æ–∫</div>
                </div>
                <div class="player-stats">
                    <div class="perc">${(p.chance*100).toFixed(2)}%</div>
                    <div class="val">${p.bet.toFixed(2)} TON</div>
                </div>
            </div>
        `).join('');
    }

    function addMyBet() {
        if(isSpinning || myBalance < 4.1) return;
        myBalance -= 4.1;
        let me = players.find(p => p.name === '@–Ø (–¢—ã)');
        if(me) me.bet += 4.1;
        else players.push({ name: '@–Ø (–¢—ã)', bet: 4.1, color: '#0098ea' });
        update();
    }

    function startTimer() {
        if(isSpinning) return;
        let time = 5;
        const tEl = document.getElementById('timer');
        const sEl = document.getElementById('status-text');
        
        let int = setInterval(() => {
            time--;
            tEl.textContent = `00:0${time}`;
            if(time <= 0) {
                clearInterval(int);
                spin();
            }
        }, 1000);
    }

    function spin() {
        isSpinning = true;
        document.getElementById('status-text').textContent = "–ò–ì–†–ê–ï–¢";
        document.getElementById('timer').textContent = "–ò–ì–†–ê";
        document.getElementById('timer').style.color = "#0ecb81";

        const total = players.reduce((s, p) => s + p.bet, 0);
        const rand = Math.random() * total;
        let current = 0;
        let winner = players[0];
        
        for(let p of players) {
            current += p.bet;
            if(rand <= current) { winner = p; break; }
        }

        const winnerMid = (winner.startAngle + winner.endAngle) / 2;
        const winnerDeg = winnerMid * (180 / Math.PI);
        const offset = (Math.random() - 0.5) * 20; // –†–∞–Ω–¥–æ–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å–µ–∫—Ç–æ—Ä–∞
        
        const extraSpins = 360 * 10; // 10 –ø–æ–ª–Ω—ã—Ö –∫—Ä—É–≥–æ–≤
        currentRotation += extraSpins + (360 - winnerDeg) + offset;
        
        document.getElementById('wheel').style.transform = `rotate(${currentRotation}deg)`;

        setTimeout(() => {
            isSpinning = false;
            alert("–ü–æ–±–µ–¥–∏–ª: " + winner.name);
            document.getElementById('timer').textContent = "00:05";
            document.getElementById('timer').style.color = "#fff";
            document.getElementById('status-text').textContent = "–î–û –ù–ê–ß–ê–õ–ê";
        }, 7000);
    }

    update();
</script>
</body>
</html>




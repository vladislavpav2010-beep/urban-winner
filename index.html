<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TONPVP Elite v2</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #000000;
            --card: #111111;
            --accent: #ff8c00;
            --success: #30d158;
            --border: rgba(255, 255, 255, 0.08);
        }
        * { box-sizing: border-box; font-family: 'Inter', sans-serif; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: #fff; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }

        /* HEADER */
        .header { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; z-index: 10; }
        .logo { font-weight: 900; font-size: 24px; letter-spacing: -1px; }
        .logo span { color: var(--accent); }
        .bal-pill { background: #1a1a1a; padding: 8px 14px; border-radius: 100px; display: flex; align-items: center; gap: 8px; font-weight: 900; border: 1px solid var(--border); }

        /* NAV */
        .nav { position: fixed; bottom: 0; width: 100%; height: 70px; background: #050505; display: flex; border-top: 1px solid var(--border); padding-bottom: 5px; z-index: 100; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 10px; font-weight: 900; color: #444; text-transform: uppercase; transition: 0.2s; cursor: pointer; }
        .nav-item.active { color: #fff; }
        .nav-item img { width: 22px; height: 22px; margin-bottom: 4px; opacity: 0.3; transition: 0.2s; }
        .nav-item.active img { opacity: 1; filter: drop-shadow(0 0 5px var(--accent)); }

        /* PAGES */
        .page { flex: 1; display: none; overflow-y: auto; padding: 10px 16px 100px; }
        .page.active { display: block; }

        /* WHEEL CONTAINER */
        .wheel-box { position: relative; width: 95vw; height: 95vw; max-width: 380px; max-height: 380px; margin: 10px auto 30px; }
        /* –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è –≤—Ä–∞—â–µ–Ω–∏—è canvas */
        #wWrap { width: 100%; height: 100%; position: relative; will-change: transform; }
        #canvas { width: 100%; height: 100%; display: block; filter: drop-shadow(0 0 20px rgba(0,0,0,0.5)); }
        
        /* –°—Ç—Ä–µ–ª–∫–∞ */
        .pointer { position: absolute; top: -12px; left: 50%; transform: translateX(-50%); z-index: 20; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.5)); }
        
        /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä—É–≥ (–¢–∞–π–º–µ—Ä/–ò–ì–†–ê) */
        .center-knob { 
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
            width: 100px; height: 100px; 
            background: #000; border-radius: 50%; 
            border: 5px solid var(--card); 
            display: flex; align-items: center; justify-content: center; 
            font-size: 36px; font-weight: 900; 
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
            z-index: 15;
            transition: all 0.3s ease;
        }
        /* –°—Ç–∏–ª—å —Ü–µ–Ω—Ç—Ä–∞, –∫–æ–≥–¥–∞ –∏–¥–µ—Ç –∏–≥—Ä–∞ */
        .center-knob.spinning {
            border-color: var(--success);
            color: var(--success);
            font-size: 22px;
            letter-spacing: 1px;
            box-shadow: 0 0 25px rgba(48, 209, 88, 0.3);
        }

        /* INPUTS */
        .bet-ctrl { display: flex; gap: 10px; margin-bottom: 20px; }
        .bet-input-wrap { flex: 1; position: relative; background: var(--card); border: 1px solid var(--border); border-radius: 16px; display: flex; align-items: center; padding: 0 5px; }
        .bet-input-wrap input { flex: 1; background: none; border: none; color: #fff; font-size: 22px; font-weight: 900; padding: 12px; text-align: center; }
        .mini-ton-icon { width: 24px; position: absolute; left: 12px; pointer-events: none; }
        .btn-bet { background: var(--accent); border: none; color: #000; padding: 0 30px; border-radius: 16px; font-weight: 900; font-size: 18px; cursor: pointer; transition: 0.2s; }
        .btn-bet:active { transform: scale(0.96); }

        /* PLAYERS LIST */
        .p-list-title { color: #555; font-size: 12px; font-weight: 900; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .p-row { display: flex; justify-content: space-between; align-items: center; padding: 10px 14px; background: var(--card); border-radius: 16px; margin-bottom: 8px; border: 1px solid var(--border); transition: 0.3s; }
        .p-info { display: flex; align-items: center; gap: 12px; }
        .p-img { width: 38px; height: 38px; border-radius: 10px; border: 2px solid transparent; box-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        .p-name { font-size: 14px; font-weight: 700; }
        .p-chance { font-size: 11px; font-weight: 900; opacity: 0.7; }
        .p-bet-val { font-size: 15px; font-weight: 900; }

        /* CHAT STYLES (Basic) */
        .chat-wrap { height: 100%; display: flex; flex-direction: column; }
        .msgs { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 8px; padding-bottom: 10px; }
        .m-sys { background: rgba(48, 209, 88, 0.1); color: var(--success); text-align: center; padding: 8px; font-size: 12px; font-weight: 700; border-radius: 12px; border: 1px solid rgba(48, 209, 88, 0.2); }
    </style>
</head>
<body>

<div class="header">
    <div class="logo">TON<span>PVP</span></div>
    <div class="bal-pill">
        <span id="h-bal">0.00</span>
        <img src="https://cryptologos.cc/logos/toncoin-ton-logo.png" style="width:18px;">
    </div>
</div>

<div id="game" class="page active">
    <div class="wheel-box">
        <svg class="pointer" width="30" height="25" viewBox="0 0 30 25" fill="none">
            <path d="M15 25L0.277568 0.25L29.7224 0.250002L15 25Z" fill="white"/>
        </svg>
        
        <div id="wWrap">
            <canvas id="canvas" width="800" height="800"></canvas>
        </div>
        
        <div class="center-knob" id="centerTxt">
            <span id="timer">15</span>
        </div>
    </div>

    <div class="bet-ctrl">
        <div class="bet-input-wrap">
            <img src="https://cryptologos.cc/logos/toncoin-ton-logo.png" class="mini-ton-icon">
            <input type="number" id="bet-val" value="1.0" step="0.1" min="0.1">
        </div>
        <button class="btn-bet" onclick="makeBet()">BET</button>
    </div>

    <div class="p-list-title">–ò–≥—Ä–æ–∫–∏ –≤ —Ä–∞—É–Ω–¥–µ (<span id="p-count">0</span>/5)</div>
    <div id="p-list"></div>
</div>

<div id="chat" class="page">
    <div class="chat-wrap">
        <div class="msgs" id="chat-box">
            <div class="m-sys">–û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã...</div>
        </div>
    </div>
</div>

<div id="profile" class="page">
    <h2 style="text-align:center; margin-top: 50px;">–ü—Ä–æ—Ñ–∏–ª—å</h2>
</div>

<div class="nav">
    <div class="nav-item active" onclick="nav('game', this)">
        <img src="https://img.icons8.com/fluency-systems-filled/48/ffffff/controller.png">–†–£–õ–ï–¢–ö–ê
    </div>
    <div class="nav-item" onclick="nav('chat', this)">
        <img src="https://img.icons8.com/fluency-systems-filled/48/ffffff/chat.png">–ß–ê–¢
    </div>
    <div class="nav-item" onclick="nav('profile', this)">
        <img src="https://img.icons8.com/fluency-systems-filled/48/ffffff/user-male-circle.png">–ü–†–û–§–ò–õ–¨
    </div>
</div>

<script>
    // == –ù–ê–°–¢–†–û–ô–ö–ò –ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==
    let user = { bal: 50.0, img: 'https://ui-avatars.com/api/?name=–í—ã&background=ff8c00&color=000&size=128' };
    let players = [], time = 15, rot = 0, isSpin = false;
    
    // –ü—É–ª –±–æ—Ç–æ–≤ —Å –≥–æ—Ç–æ–≤—ã–º–∏ URL –∫–∞—Ä—Ç–∏–Ω–æ–∫
    const botPool = [
        { name: '@PepeMaster', imgUrl: 'https://raw.githubusercontent.com/Tarikul-Islam-Anik/Animated-Fluent-Emojis/master/Emojis/Animals/Frog.png', color: '#30d158' },
        { name: '@TonWhale', imgUrl: 'https://img.icons8.com/fluency/96/whale.png', color: '#0088cc' },
        { name: '@RichDuck', imgUrl: 'https://img.icons8.com/fluency/96/duck.png', color: '#ffd60a' },
        { name: '@DogeCoin', imgUrl: 'https://img.icons8.com/fluency/96/doge.png', color: '#e3b044' }
    ];

    const canvas = document.getElementById('canvas'), ctx = canvas.getContext('2d');
    const centerTxt = document.getElementById('centerTxt');
    const timerSpan = document.getElementById('timer');

    // == –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –û–¢–†–ò–°–û–í–ö–ò –ö–û–õ–ï–°–ê (–° –ê–í–ê–¢–ê–†–ö–ê–ú–ò) ==
    function draw() {
        const r = 400; // –†–∞–¥–∏—É—Å canvas (800/2)
        const wheelR = 380; // –†–∞–¥–∏—É—Å —Å–∞–º–æ–≥–æ –∫–æ–ª–µ—Å–∞ (—á—É—Ç—å –º–µ–Ω—å—à–µ canvas –¥–ª—è —Ç–µ–Ω–∏)
        ctx.clearRect(0,0,800,800);

        // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫–æ–≤ –Ω–µ—Ç - —Ä–∏—Å—É–µ–º –ø—É—Å—Ç–æ–π —Ç–µ–º–Ω—ã–π –∫—Ä—É–≥
        if(!players.length) { 
            ctx.beginPath(); ctx.arc(r,r,wheelR,0,Math.PI*2); 
            ctx.fillStyle="#161618"; ctx.fill(); 
            ctx.strokeStyle = "#222"; ctx.lineWidth = 10; ctx.stroke();
            return; 
        }

        let total = players.reduce((s,p)=>s+p.bet, 0);
        let start = -Math.PI / 2; // –ù–∞—á–∏–Ω–∞–µ–º —Ä–∏—Å–æ–≤–∞—Ç—å —Å –≤–µ—Ä—Ö–∞ (–≥–¥–µ —Å—Ç—Ä–µ–ª–∫–∞)

        players.forEach(p => {
            const slice = (p.bet/total)*Math.PI*2; // –£–≥–æ–ª —Å–µ–∫—Ç–æ—Ä–∞ –∏–≥—Ä–æ–∫–∞
            p.mid = start + slice/2; // –°–µ—Ä–µ–¥–∏–Ω–∞ —Å–µ–∫—Ç–æ—Ä–∞ (–¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –∞–≤–∞—Ç–∞—Ä–∫–∏)

            // 1. –†–∏—Å—É–µ–º —Å–∞–º —Å–µ–∫—Ç–æ—Ä (—Ü–≤–µ—Ç–Ω–æ–π –∫—É—Å–æ–∫ –ø–∏—Ä–æ–≥–∞)
            ctx.beginPath(); 
            ctx.moveTo(r,r); 
            ctx.arc(r, r, wheelR, start, start+slice);
            ctx.fillStyle = p.color; 
            ctx.fill();
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–Ω–∫—É—é –æ–±–≤–æ–¥–∫—É –º–µ–∂–¥—É —Å–µ–∫—Ç–æ—Ä–∞–º–∏
            ctx.strokeStyle = "rgba(0,0,0,0.2)"; ctx.lineWidth = 4; ctx.stroke();

            // 2. –†–∏—Å—É–µ–º –ê–í–ê–¢–ê–†–ö–£ –≤–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ç–æ—Ä–∞
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (ctx.save/restore), —á—Ç–æ–±—ã –ø–æ–≤–æ—Ä–æ—Ç—ã –Ω–µ –≤–ª–∏—è–ª–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ç–æ—Ä–∞
            if(slice > 0.2) { // –†–∏—Å—É–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–µ–∫—Ç–æ—Ä –Ω–µ —Å–ª–∏—à–∫–æ–º —É–∑–∫–∏–π
                ctx.save();
                ctx.translate(r, r); // –ü–µ—Ä–µ–Ω–æ—Å–∏–º —Ç–æ—á–∫—É –æ—Ç—Å—á–µ—Ç–∞ –≤ —Ü–µ–Ω—Ç—Ä –∫–æ–ª–µ—Å–∞
                ctx.rotate(p.mid);   // –ü–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º —Ö–æ–ª—Å—Ç –∫ —Å–µ—Ä–µ–¥–∏–Ω–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞
                ctx.translate(wheelR * 0.65, 0); // –°–¥–≤–∏–≥–∞–µ–º—Å—è –ø–æ —Ä–∞–¥–∏—É—Å—É –±–ª–∏–∂–µ –∫ –∫—Ä–∞—é (–ø–æ–∑–∏—Ü–∏—è –∞–≤–∞—Ç–∞—Ä–∫–∏)
                ctx.rotate(Math.PI / 2); // –ü–æ–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –∞–≤–∞—Ç–∞—Ä–∫—É –Ω–∞ 90 –≥—Ä–∞–¥—É—Å–æ–≤, —á—Ç–æ–±—ã "–Ω–∏–∑" —Å–º–æ—Ç—Ä–µ–ª –≤ —Ü–µ–Ω—Ç—Ä –∫–æ–ª–µ—Å–∞

                // –°–æ–∑–¥–∞–µ–º –∫—Ä—É–≥–ª—É—é –º–∞—Å–∫—É (clipping path)
                ctx.beginPath();
                ctx.arc(0, 0, 35, 0, Math.PI * 2); // –ö—Ä—É–≥ —Ä–∞–¥–∏—É—Å–æ–º 35px
                ctx.closePath();
                
                // –†–∏—Å—É–µ–º —Ç–µ–Ω—å –∏ –æ–±–≤–æ–¥–∫—É –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∫–∏ –≤–Ω—É—Ç—Ä–∏ –∫–æ–ª–µ—Å–∞
                ctx.shadowColor = "rgba(0,0,0,0.5)"; ctx.shadowBlur = 10;
                ctx.strokeStyle = "#fff"; ctx.lineWidth = 3; ctx.stroke();
                ctx.shadowBlur = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–µ–Ω—å –ø–µ—Ä–µ–¥ –∫–ª–∏–ø–ø–∏–Ω–≥–æ–º

                ctx.clip(); // –û–±—Ä–µ–∑–∞–µ–º –≤—Å–µ, —á—Ç–æ –±—É–¥–µ—Ç –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω–æ –¥–∞–ª—å—à–µ, –ø–æ —ç—Ç–æ–º—É –∫—Ä—É–≥—É

                // –†–∏—Å—É–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å
                if (p.imgObj && p.imgObj.complete) {
                     // –†–∏—Å—É–µ–º –∫–∞—Ä—Ç–∏–Ω–∫—É 70x70 —Å–æ —Å–º–µ—â–µ–Ω–∏–µ–º -35,-35, —á—Ç–æ–±—ã —Ü–µ–Ω—Ç—Ä –±—ã–ª –≤ 0,0
                     ctx.drawImage(p.imgObj, -35, -35, 70, 70);
                } else {
                    // –ó–∞–≥–ª—É—à–∫–∞, –ø–æ–∫–∞ –≥—Ä—É–∑–∏—Ç—Å—è
                    ctx.fillStyle = "#ddd"; ctx.fill(); 
                }
                ctx.restore(); // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            }

            start += slice; // –î–≤–∏–≥–∞–µ–º –Ω–∞—á–∞–ª–æ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–µ–∫—Ç–æ—Ä–∞
        });
    }

    // == –ò–ì–†–û–í–û–ô –¶–ò–ö–õ –ò –õ–û–ì–ò–ö–ê ==
    function gameLoop() {
        // –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º —Ä–∞—É–Ω–¥–æ–º
        players = []; time = 15; isSpin = false;
        centerTxt.classList.remove('spinning'); // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤–∏–¥ —Ç–∞–π–º–µ—Ä–∞
        document.getElementById('wWrap').style.transition = 'none';
        rot %= 360; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ª–∏—à–Ω–∏–µ –æ–±–æ—Ä–æ—Ç—ã
        document.getElementById('wWrap').style.transform = `rotate(${rot}deg)`;
        
        updateUI(); draw();

        // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
        const t = setInterval(() => {
            if(isSpin) { clearInterval(t); return; } // –ï—Å–ª–∏ —É–∂–µ –∫—Ä—É—Ç–∏—Ç—Å—è, —Ç–∞–π–º–µ—Ä –Ω–µ –Ω—É–∂–µ–Ω
            timerSpan.textContent = time; // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–∏—Ñ—Ä—ã –≤ —Ü–µ–Ω—Ç—Ä–µ
            
            // –î–æ–±–∞–≤–ª—è–µ–º –±–æ—Ç–æ–≤ –¥–ª—è –º–∞—Å—Å–æ–≤–∫–∏
            if(time % 4 === 0 && players.length < 4 && time > 3) {
                addBot();
            }

            // –í—Ä–µ–º—è –≤—ã—à–ª–æ
            if(--time < 0) { 
                clearInterval(t); 
                // –ï—Å–ª–∏ –∏–≥—Ä–æ–∫–æ–≤ >= 2, –∫—Ä—É—Ç–∏–º. –ò–Ω–∞—á–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫.
                players.length >= 2 ? spin() : setTimeout(gameLoop, 1000);
            }
        }, 1000);
    }

    // –§—É–Ω–∫—Ü–∏—è –í–†–ê–©–ï–ù–ò–Ø
    function spin() {
        isSpin = true;
        // –ú–µ–Ω—è–µ–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫—Ä—É–≥ –Ω–∞ "–ò–ì–†–ê"
        timerSpan.textContent = "–ò–ì–†–ê";
        centerTxt.classList.add('spinning');

        // –í—ã–±–∏—Ä–∞–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è (—á–µ–º –±–æ–ª—å—à–µ —Å—Ç–∞–≤–∫–∞, —Ç–µ–º –≤—ã—à–µ —à–∞–Ω—Å)
        let total = players.reduce((s,p)=>s+p.bet,0);
        let rand = Math.random()*total, acc=0, win;
        for(let p of players) { acc += p.bet; if(rand <= acc) { win = p; break; } }

        // –í—ã—á–∏—Å–ª—è–µ–º —É–≥–æ–ª –æ—Å—Ç–∞–Ω–æ–≤–∫–∏. 
        // –ù–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —Å–µ—Ä–µ–¥–∏–Ω–∞ —Å–µ–∫—Ç–æ—Ä–∞ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è (win.mid) –æ–∫–∞–∑–∞–ª–∞—Å—å —Å–≤–µ—Ä—Ö—É (-Math.PI/2 –∏–ª–∏ 270deg).
        // –§–æ—Ä–º—É–ª–∞: –¢–µ–∫—É—â–∏–π —É–≥–æ–ª + 5 –ø–æ–ª–Ω—ã—Ö –æ–±–æ—Ä–æ—Ç–æ–≤ + (—É–≥–æ–ª –¥–æ —Å—Ç—Ä–µ–ª–∫–∏)
        let stopAngle = (360 * 5) + (270 - (win.mid * 180 / Math.PI));
        rot = stopAngle;

        // –ó–∞–ø—É—Å–∫–∞–µ–º CSS –∞–Ω–∏–º–∞—Ü–∏—é
        const wrap = document.getElementById('wWrap');
        // cubic-bezier –¥–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç —Ä–∞–∑–≥–æ–Ω–∞ –∏ –º–µ–¥–ª–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
        wrap.style.transition = 'transform 8s cubic-bezier(0.2, 0, 0.1, 1)';
        wrap.style.transform = `rotate(${rot}deg)`;
        
        // –î–µ–π—Å—Ç–≤–∏—è –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–æ–ª–µ—Å–∞ (—á–µ—Ä–µ–∑ 8 —Å–µ–∫—É–Ω–¥)
        setTimeout(() => {
             addChatMessage(`üéâ –ü–æ–±–µ–¥–∏–ª <b>${win.name}</b>! –í—ã–∏–≥—Ä—ã—à: ${total.toFixed(2)} TON`, true);
            if(win.name === user.name) user.bal += total;
            // –ü–∞—É–∑–∞ –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º —Ä–∞—É–Ω–¥–æ–º
            setTimeout(gameLoop, 4000);
        }, 8200);
    }

    // == –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ==

    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞
    function addBot() {
        const botData = botPool[Math.floor(Math.random()*botPool.length)];
        addPlayer(botData.name, (Math.random() * 5 + 0.5), botData.color, botData.imgUrl);
    }

    // –°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É (–ò–≥—Ä–æ–∫)
    function makeBet() {
        let v = parseFloat(document.getElementById('bet-val').value);
        if(isSpin || v <= 0 || v > user.bal || players.find(p=>p.name==='@–í—ã')) return;
        user.bal -= v;
        addPlayer('@–í—ã', v, varColor('--accent'), user.img);
    }

    // –û–±—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞ –≤ –º–∞—Å—Å–∏–≤ –∏ –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏
    function addPlayer(name, bet, color, imgUrl) {
        const imgObj = new Image();
        imgObj.src = imgUrl;
        // –í–∞–∂–Ω–æ: –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –∫–æ–ª–µ—Å–æ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∞ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å
        imgObj.onload = draw; 
        
        players.push({ name, bet, color, imgObj, mid: 0 });
        updateUI(); draw();
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (—Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤, –±–∞–ª–∞–Ω—Å)
    function updateUI() {
        document.getElementById('h-bal').textContent = user.bal.toFixed(2);
        document.getElementById('p-count').textContent = players.length;
        const total = players.reduce((s,p)=>s+p.bet, 0);
        
        document.getElementById('p-list').innerHTML = players.sort((a,b)=>b.bet-a.bet).map(p => `
            <div class="p-row" style="border-left: 4px solid ${p.color}">
                <div class="p-info">
                    <img src="${p.imgObj ? p.imgObj.src : ''}" class="p-img" style="border-color:${p.color}">
                    <div>
                        <div class="p-name">${p.name}</div>
                        <div class="p-chance" style="color:${p.color}">${((p.bet/total)*100 || 0).toFixed(1)}%</div>
                    </div>
                </div>
                <div class="p-bet-val">${p.bet.toFixed(2)} TON</div>
            </div>
        `).join('');
    }

    function addChatMessage(msg, isSys=false) {
        const cb = document.getElementById('chat-box');
        cb.innerHTML += isSys ? `<div class="m-sys">${msg}</div>` : `<div>${msg}</div>`;
        cb.scrollTop = cb.scrollHeight;
    }

    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –∏–∑ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    function varColor(name) { return getComputedStyle(document.documentElement).getPropertyValue(name).trim(); }

    // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ç–∞–±–∞–º
    function nav(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active');
    }

    // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    gameLoop();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>TON ROLLS ELITE - –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ ‚Ññ1</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&family=Outfit:wght@600;700;800;900&display=swap" rel="stylesheet">
    
    <style>
        /* =========================================
           1. –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï (CSS VARIABLES)
           =========================================
        */
        :root {
            --bg-main: #050505;
            --bg-card: #0d0d0f;
            --bg-darker: #080808;
            --bg-lighter: #121214;
            
            --color-accent: #0088cc;
            --color-accent-glow: rgba(0, 136, 204, 0.4);
            --color-gold: #f7a809;
            --color-gold-glow: rgba(247, 168, 9, 0.3);
            --color-text-bright: #ffffff;
            --color-text-muted: #707075;
            --color-border: #1f1f22;
            --color-green: #2ecb71;
            --color-red: #e74c3c;
            --color-purple: #a335ee;
            
            --transition-fast: 0.2s ease;
            --transition-medium: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow-standard: 0 4px 15px rgba(0,0,0,0.5);
        }

        /* =========================================
           2. –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò –°–ë–†–û–°–ê (RESET)
           =========================================
        */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-drag: none;
        }

        html, body {
            width: 100%;
            height: 100%;
            background-color: var(--bg-main);
            color: var(--color-text-bright);
            font-family: 'Manrope', sans-serif;
            overflow: hidden; /* –ó–∞–ø—Ä–µ—Ç —Å–∫—Ä–æ–ª–ª–∞ –≤—Å–µ–≥–æ —Ç–µ–ª–∞ –¥–ª—è App-like —ç—Ñ—Ñ–µ–∫—Ç–∞ */
            line-height: 1.4;
        }

        /* =========================================
           3. –®–ê–ü–ö–ê –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø (HEADER)
           =========================================
        */
        .header {
            height: 65px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            background: rgba(5, 5, 5, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--color-border);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }

        .logo {
            font-family: 'Outfit', sans-serif;
            font-weight: 900;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            letter-spacing: -0.5px;
        }

        .logo svg {
            width: 26px;
            height: 26px;
            filter: drop-shadow(0 0 5px var(--color-accent));
        }

        .header-rigth {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .balance-pill {
            background: var(--bg-lighter);
            padding: 7px 14px;
            border-radius: 100px;
            border: 1px solid var(--color-border);
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 800;
            font-family: 'Outfit', sans-serif;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
        }

        .balance-pill span {
            font-size: 15px;
        }

        .balance-pill svg {
            width: 18px;
            height: 18px;
        }

        .icon-btn {
            width: 40px;
            height: 40px;
            background: var(--bg-card);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--color-border);
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .icon-btn:active {
            transform: scale(0.9);
            background: var(--color-border);
        }

        /* =========================================
           4. –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ (SCREENS)
           =========================================
        */
        .content {
            padding-top: 65px;
            padding-bottom: 90px;
            height: 100vh;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .screen {
            display: none;
            padding: 20px 15px;
            animation: screenFadeIn 0.4s ease;
        }

        .screen.active {
            display: block;
        }

        @keyframes screenFadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* =========================================
           5. –ö–ï–ô–°-–†–£–õ–ï–¢–ö–ê (ELITE CASE SYSTEM)
           =========================================
        */
        .case-container {
            text-align: center;
            width: 100%;
        }

        .roulette-wrapper {
            position: relative;
            width: 100%;
            height: 130px;
            background: #080809;
            border: 1px solid var(--color-border);
            border-radius: 20px;
            margin: 25px 0;
            overflow: hidden;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.8);
        }

        .roulette-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--color-accent);
            z-index: 50;
            transform: translateX(-50%);
            box-shadow: 0 0 15px var(--color-accent);
        }

        .roulette-line::before, .roulette-line::after {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 0; height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
        }
        .roulette-line::before { top: 0; border-top: 10px solid var(--color-accent); }
        .roulette-line::after { bottom: 0; border-bottom: 10px solid var(--color-accent); }

        .roulette-track {
            display: flex;
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            transition: transform 6s cubic-bezier(0.15, 0, 0.05, 1);
            will-change: transform;
            align-items: center;
        }

        .case-item {
            min-width: 110px;
            height: 110px;
            margin: 0 6px;
            background: var(--bg-card);
            border: 1px solid var(--color-border);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            position: relative;
            transition: 0.3s;
        }

        .case-item span.amount {
            font-family: 'Outfit';
            font-size: 14px;
            margin-top: 5px;
        }

        .case-item.rare { border-color: var(--color-accent); background: rgba(0, 136, 204, 0.05); }
        .case-item.epic { border-color: var(--color-purple); background: rgba(163, 53, 238, 0.05); }
        .case-item.legendary { 
            border-color: var(--color-gold); 
            background: rgba(247, 168, 9, 0.05);
            box-shadow: inset 0 0 10px var(--color-gold-glow);
        }

        /* =========================================
           6. –°–ï–¢–ö–ê –ü–†–ï–î–ú–ï–¢–û–í (CASE DROP LIST)
           =========================================
        */
        .drop-list {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 30px;
            padding: 0 5px;
        }

        .drop-card {
            background: var(--bg-card);
            border: 1px solid var(--color-border);
            border-radius: 15px;
            padding: 12px 8px;
            text-align: center;
            transition: transform 0.2s;
        }

        .drop-card img, .drop-card .emoji {
            font-size: 28px;
            margin-bottom: 8px;
            display: block;
        }

        .drop-card .val {
            font-weight: 800;
            font-size: 13px;
            color: var(--color-text-bright);
        }

        .drop-card .prob {
            font-size: 9px;
            color: var(--color-text-muted);
            margin-top: 4px;
            text-transform: uppercase;
            font-weight: 700;
        }

        /* =========================================
           7. –ò–ù–¢–ï–†–§–ï–ô–° SOLO (–ú–ï–ù–Æ)
           =========================================
        */
        .solo-menu-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .mode-card {
            background: var(--bg-lighter);
            border: 1px solid var(--color-border);
            border-radius: 24px;
            padding: 25px;
            position: relative;
            overflow: hidden;
            transition: var(--transition-medium);
        }

        .mode-card:active { transform: scale(0.97); }

        .mode-card h3 {
            font-family: 'Outfit';
            font-size: 24px;
            margin-bottom: 6px;
            color: var(--color-accent);
        }

        .mode-card p {
            font-size: 13px;
            color: var(--color-text-muted);
        }

        .mode-card .badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--color-gold);
            color: #000;
            font-size: 10px;
            font-weight: 900;
            padding: 4px 10px;
            border-radius: 8px;
            text-transform: uppercase;
        }

        /* =========================================
           8. –ö–ù–û–ü–ö–ò –ò –í–í–û–î (UI CONTROLS)
           =========================================
        */
        .main-btn {
            width: 100%;
            padding: 20px;
            background: var(--color-accent);
            color: #fff;
            border-radius: 18px;
            font-weight: 900;
            font-family: 'Outfit', sans-serif;
            text-transform: uppercase;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 15px var(--color-accent-glow);
            transition: var(--transition-fast);
            font-size: 16px;
            letter-spacing: 0.5px;
        }

        .main-btn:active { transform: translateY(2px); box-shadow: none; }
        .main-btn:disabled { 
            background: #252528; 
            color: #555; 
            box-shadow: none; 
            cursor: not-allowed; 
        }

        .back-btn {
            background: transparent;
            border: 1px solid var(--color-border);
            color: var(--color-text-bright);
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 700;
            margin-bottom: 20px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        /* =========================================
           9. PVP ARENA (–ö–û–õ–ï–°–û)
           =========================================
        */
        .arena-card {
            background: var(--bg-card);
            border-radius: 28px;
            padding: 25px;
            text-align: center;
            border: 1px solid var(--color-border);
        }

        .wheel-box {
            position: relative;
            width: 280px;
            height: 280px;
            margin: 20px auto;
        }

        canvas#wheel {
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }

        .wheel-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 75px;
            height: 75px;
            background: var(--bg-main);
            border-radius: 50%;
            border: 4px solid var(--color-border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 900;
            font-family: 'Outfit';
            z-index: 10;
        }

        /* =========================================
           10. –ù–ê–í–ò–ì–ê–¶–ò–Ø (BOTTOM NAV)
           =========================================
        */
        .nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            height: 85px;
            background: rgba(8, 8, 8, 0.95);
            backdrop-filter: blur(15px);
            border-top: 1px solid var(--color-border);
            display: flex;
            justify-content: space-around;
            padding-bottom: 20px;
            z-index: 1000;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            color: var(--color-text-muted);
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            width: 25%;
            transition: var(--transition-fast);
        }

        .nav-item.active {
            color: var(--color-accent);
        }

        .nav-item svg {
            width: 24px;
            height: 24px;
            fill: currentColor;
        }

        /* =========================================
           11. –ü–†–û–§–ò–õ–¨ –ò –ü–†–û–ì–†–ï–°–°
           =========================================
        */
        .lvl-section {
            background: var(--bg-lighter);
            border-radius: 20px;
            padding: 20px;
            border: 1px solid var(--color-border);
            margin-top: 20px;
        }

        .lvl-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 800;
            font-size: 13px;
        }

        .lvl-bar-bg {
            height: 10px;
            background: #1a1a1e;
            border-radius: 10px;
            overflow: hidden;
        }

        .lvl-bar-fill {
            height: 100%;
            background: var(--color-accent);
            width: 0%;
            transition: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 10px var(--color-accent-glow);
        }

    </style>
</head>
<body>

    <svg id="ton-logo-svg" style="display: none;" viewBox="0 0 512 512">
        <circle cx="256" cy="256" r="256" fill="#0098EA"/>
        <path d="M113.81 184.223L243.621 391.705C248.983 400.279 263.017 400.279 268.379 391.705L398.19 184.223C404.93 173.444 397.202 159 384.49 159H127.51C114.798 159 107.07 173.444 113.81 184.223Z" fill="white"/>
    </svg>

    <header class="header">
        <div class="logo">
            <svg><use href="#ton-logo-svg"></use></svg>
            <span>TON ROLLS</span>
        </div>
        <div class="header-rigth">
            <div class="balance-pill">
                <span id="bal-display">0.00</span>
                <svg><use href="#ton-logo-svg"></use></svg>
            </div>
            <div class="icon-btn" onclick="openChat()">üí¨</div>
        </div>
    </header>

    <main class="content">
        
        <section id="view-pvp" class="screen active">
            <div class="arena-card">
                <div style="text-transform: uppercase; font-size: 11px; color: var(--color-text-muted); font-weight: 800; letter-spacing: 1px;">–û–±—â–∏–π –±–∞–Ω–∫ –±–∏—Ç–≤—ã</div>
                <div id="pvp-bank" style="font-size: 28px; font-weight: 900; font-family: 'Outfit'; color: var(--color-gold); margin: 5px 0;">0.00 TON</div>
                
                <div class="wheel-box">
                    <canvas id="wheel" width="600" height="600"></canvas>
                    <div class="wheel-center" id="pvp-timer">20</div>
                    <div style="position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 25px solid #fff; z-index: 100;"></div>
                </div>

                <div style="background: var(--bg-lighter); border: 1px solid var(--color-border); border-radius: 16px; padding: 12px; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                    <svg style="width:20px; height:20px;"><use href="#ton-logo-svg"></use></svg>
                    <input type="number" id="pvp-bet" value="1.00" style="background:none; border:none; color:#fff; font-size:18px; font-weight:800; width:100%; outline:none;">
                </div>
                
                <button class="main-btn" onclick="handleJoinPVP()">–í—Å—Ç—É–ø–∏—Ç—å –≤ –∏–≥—Ä—É</button>
            </div>
        </section>

        <section id="view-solo" class="screen">
            
            <div id="solo-main-menu">
                <h2 style="font-family: 'Outfit'; text-align: center; margin-bottom: 20px;">–ò–ì–†–û–í–´–ï –†–ï–ñ–ò–ú–´</h2>
                <div class="solo-menu-grid">
                    
                    <div class="mode-card" onclick="switchSolo('elite')">
                        <div class="badge">Hot</div>
                        <h3>ELITE CASE</h3>
                        <p>–¶–µ–Ω–∞: 1.50 TON. –ò—Å–ø—ã—Ç–∞–π —É–¥–∞—á—É –≤ —Ä—É–ª–µ—Ç–∫–µ!</p>
                    </div>

                    <div class="mode-card" onclick="switchSolo('upgrade')">
                        <h3>UPGRADE</h3>
                        <p>–†–∏—Å–∫—É–π –∏ —É–º–Ω–æ–∂–∞–π –±–∞–ª–∞–Ω—Å –¥–æ x50 –∑–∞ —Ä–∞–∑.</p>
                    </div>

                    <div class="mode-card" onclick="switchSolo('lvl-cases')">
                        <h3>LVL CASES</h3>
                        <p>–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –∫–µ–π—Å—ã –∑–∞ –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å.</p>
                    </div>

                </div>
            </div>

            <div id="solo-elite-view" style="display: none;">
                <button class="back-btn" onclick="exitSoloMode()">‚óÄ –ö —Å–ø–∏—Å–∫—É —Ä–µ–∂–∏–º–æ–≤</button>
                <div class="case-container">
                    <h2 style="font-family: 'Outfit';">ELITE ROLL</h2>
                    <p style="color: var(--color-text-muted); font-size: 13px;">–°—Ç–æ–∏–º–æ—Å—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏—è ‚Äî 1.50 TON</p>

                    <div class="roulette-wrapper">
                        <div class="roulette-line"></div>
                        <div id="roulette-track" class="roulette-track"></div>
                    </div>

                    <button id="btn-spin-elite" class="main-btn" onclick="startEliteSpin()">–û–¢–ö–†–´–¢–¨ –ó–ê 1.5 TON</button>

                    <div style="margin-top: 35px; text-align: left;">
                        <span style="font-size: 12px; font-weight: 800; color: var(--color-text-muted); padding-left: 5px;">–°–û–î–ï–†–ñ–ò–ú–û–ï –ö–ï–ô–°–ê:</span>
                        <div class="drop-list" id="elite-drop-list">
                            </div>
                    </div>
                </div>
            </div>

            <div id="solo-upgrade-view" style="display: none;">
                <button class="back-btn" onclick="exitSoloMode()">‚óÄ –ù–∞–∑–∞–¥</button>
                <div style="text-align: center; padding: 20px;">
                    <h2 style="font-family: 'Outfit';">UPGRADE MODE</h2>
                    <div id="up-chance-display" style="font-size: 48px; font-weight: 900; color: var(--color-accent); margin: 30px 0;">47.5%</div>
                    <button class="main-btn" onclick="handleUpgrade()">–ü–æ–ø—ã—Ç–∞—Ç—å —É–¥–∞—á—É</button>
                </div>
            </div>

        </section>

        <section id="view-profile" class="screen">
            <div style="text-align: center;">
                <div style="position: relative; display: inline-block;">
                    <img src="https://ui-avatars.com/api/?name=P&background=0088cc&color=fff" style="width: 90px; border-radius: 25px; border: 3px solid var(--color-border);">
                </div>
                <h3 style="margin-top: 15px; font-family: 'Outfit'; font-size: 22px;">@Player_TON</h3>
                
                <div class="lvl-section">
                    <div class="lvl-info">
                        <span>–£–†–û–í–ï–ù–¨ <span id="user-lvl">1</span></span>
                        <span id="lvl-next-val">10.00 TON</span>
                    </div>
                    <div class="lvl-bar-bg">
                        <div id="user-lvl-fill" class="lvl-bar-fill"></div>
                    </div>
                    <div style="margin-top: 10px; font-size: 10px; color: var(--color-text-muted); text-align: left;">
                        –ü—Ä–æ–∫—Ä—É—á–µ–Ω–æ –≤—Å–µ–≥–æ: <span id="user-wager">0.00</span> / <span id="user-target">10.00</span> TON
                    </div>
                </div>

                <div style="margin-top: 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div style="background: var(--bg-card); padding: 15px; border-radius: 15px; border: 1px solid var(--color-border);">
                        <div style="font-size: 10px; color: var(--color-text-muted);">–ò–≥—Ä –≤ PVP</div>
                        <div style="font-weight: 800;">12</div>
                    </div>
                    <div style="background: var(--bg-card); padding: 15px; border-radius: 15px; border: 1px solid var(--color-border);">
                        <div style="font-size: 10px; color: var(--color-text-muted);">–ö–µ–π—Å–æ–≤ –æ—Ç–∫—Ä—ã—Ç–æ</div>
                        <div style="font-weight: 800;">4</div>
                    </div>
                </div>

                <button onclick="systemReset()" style="margin-top: 40px; color: var(--color-red); background: none; border: 1px solid var(--color-red); padding: 10px; border-radius: 10px; font-size: 12px; width: 100%;">–°–ë–†–û–°–ò–¢–¨ –î–ê–ù–ù–´–ï –ê–ö–ö–ê–£–ù–¢–ê</button>
            </div>
        </section>

    </main>

    <nav class="nav">
        <div class="nav-item active" onclick="navigate('pvp', this)">
            <svg viewBox="0 0 24 24"><path d="M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"/></svg>
            <span>–ê—Ä–µ–Ω–∞</span>
        </div>
        <div class="nav-item" onclick="navigate('solo', this)">
            <svg viewBox="0 0 24 24"><path d="M13 3h-2v10h2V3zm4.83 2.17l-1.42 1.42C17.99 7.86 19 9.81 19 12c0 3.87-3.13 7-7 7s-7-3.13-7-7c0-2.19 1.01-4.14 2.58-5.42L6.17 5.17C4.23 6.82 3 9.26 3 12c0 4.97 4.03 9 9 9s9-4.03 9-9c0-2.74-1.23-5.18-3.17-6.83z"/></svg>
            <span>Solo</span>
        </div>
        <div class="nav-item" onclick="navigate('profile', this)">
            <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </div>
    </nav>

    <script>
        /**
         * –ì–õ–û–ë–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï (STATE)
         */
        let appState = {
            balance: parseFloat(localStorage.getItem('user_bal')) || 10.00,
            wager: parseFloat(localStorage.getItem('user_wager')) || 0.00,
            level: parseInt(localStorage.getItem('user_lvl')) || 1,
            isSpinning: false,
            currentScreen: 'pvp',
            pvp: {
                totalBank: 0.00,
                timer: 20,
                players: []
            }
        };

        /**
         * –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –≠–õ–ò–¢–ù–û–ì–û –ö–ï–ô–°–ê (1.5 TON)
         */
        const ELITE_CASE_ITEMS = [
            { id: 1, name: "–û–∫—É—Ä–æ–∫", val: 0.10, chance: 40, rarity: 'common', icon: 'üí©' },
            { id: 2, name: "–ö–æ—Ä–æ–±–∫–∞", val: 0.35, chance: 30, rarity: 'common', icon: 'üì¶' },
            { id: 3, name: "–ú–∞–ª—ã–π TON", val: 1.00, chance: 15, rarity: 'rare', icon: 'üíé' },
            { id: 4, name: "–û–ö–£–ü", val: 1.50, chance: 14.8, rarity: 'rare', icon: 'üí∞' },
            { id: 5, name: "SILVER", val: 50.0, chance: 0.15, rarity: 'epic', icon: 'üî•' },
            { id: 6, name: "JACKPOT", val: 100.0, chance: 0.05, rarity: 'legendary', icon: 'üëë' }
        ];

        /**
         * –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
         */
        window.addEventListener('DOMContentLoaded', () => {
            renderEliteItemsInfo();
            updateGlobalUI();
            
            // –ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è PVP –∫–æ–ª–µ—Å–∞
            const canvas = document.getElementById('wheel');
            const ctx = canvas.getContext('2d');
            ctx.beginPath();
            ctx.arc(300, 300, 280, 0, 2 * Math.PI);
            ctx.fillStyle = '#121214';
            ctx.fill();
        });

        /**
         * –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê
         */
        function updateGlobalUI() {
            document.getElementById('bal-display').innerText = appState.balance.toFixed(2);
            document.getElementById('user-lvl').innerText = appState.level;
            document.getElementById('user-wager').innerText = appState.wager.toFixed(2);
            
            const target = appState.level * 15; // –§–æ—Ä–º—É–ª–∞ —É—Ä–æ–≤–Ω—è
            document.getElementById('user-target').innerText = target.toFixed(2);
            document.getElementById('lvl-next-val').innerText = target.toFixed(2) + " TON";
            
            const perc = (appState.wager / target) * 100;
            document.getElementById('user-lvl-fill').style.width = Math.min(perc, 100) + "%";
            
            localStorage.setItem('user_bal', appState.balance);
            localStorage.setItem('user_wager', appState.wager);
            localStorage.setItem('user_lvl', appState.level);
        }

        /**
         * –ù–ê–í–ò–ì–ê–¶–ò–Ø –ú–ï–ñ–î–£ –≠–ö–†–ê–ù–ê–ú–ò
         */
        function navigate(screenId, el) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            
            document.getElementById('view-' + screenId).classList.add('active');
            el.classList.add('active');
            appState.currentScreen = screenId;
        }

        /**
         * –£–ü–†–ê–í–õ–ï–ù–ò–ï SOLO –†–ï–ñ–ò–ú–ê–ú–ò
         */
        function switchSolo(mode) {
            document.getElementById('solo-main-menu').style.display = 'none';
            if(mode === 'elite') {
                document.getElementById('solo-elite-view').style.display = 'block';
                prepareRoulette();
            } else if(mode === 'upgrade') {
                document.getElementById('solo-upgrade-view').style.display = 'block';
            }
        }

        function exitSoloMode() {
            document.getElementById('solo-main-menu').style.display = 'block';
            document.getElementById('solo-elite-view').style.display = 'none';
            document.getElementById('solo-upgrade-view').style.display = 'none';
        }

        /**
         * –õ–û–ì–ò–ö–ê –≠–õ–ò–¢–ù–û–ì–û –ö–ï–ô–°–ê
         */
        function renderEliteItemsInfo() {
            const list = document.getElementById('elite-drop-list');
            list.innerHTML = ELITE_CASE_ITEMS.map(item => `
                <div class="drop-card" style="border-bottom: 2px solid var(--color-${item.rarity === 'common' ? 'border' : (item.rarity === 'rare' ? 'accent' : (item.rarity === 'epic' ? 'purple' : 'gold'))})">
                    <span class="emoji">${item.icon}</span>
                    <div class="val">${item.val.toFixed(2)}</div>
                    <div class="prob">${item.chance}%</div>
                </div>
            `).join('');
        }

        function prepareRoulette() {
            const track = document.getElementById('roulette-track');
            track.style.transition = 'none';
            track.style.transform = 'translateX(0)';
            track.innerHTML = '';
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 70 —Å–ª—É—á–∞–π–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –¥–ª—è –ª–µ–Ω—Ç—ã
            for(let i = 0; i < 80; i++) {
                // –í –Ω–∞—á–∞–ª–µ –∏ –∫–æ–Ω—Ü–µ –ª–µ–Ω—Ç—ã —Å—Ç–∞–≤–∏–º –±–æ–ª—å—à–µ "–º—É—Å–æ—Ä–∞" –¥–ª—è —Ä–µ–∞–ª–∏–∑–º–∞
                const randItem = ELITE_CASE_ITEMS[Math.floor(Math.random() * 4)]; 
                const card = createItemCard(randItem);
                track.appendChild(card);
            }
        }

        function createItemCard(item) {
            const div = document.createElement('div');
            div.className = `case-item ${item.rarity}`;
            div.innerHTML = `
                <span style="font-size: 32px;">${item.icon}</span>
                <span class="amount">${item.val.toFixed(2)}</span>
            `;
            return div;
        }

        function startEliteSpin() {
            if(appState.isSpinning) return;
            if(appState.balance < 1.5) {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è!");
                return;
            }

            // –°–ø–∏—Å—ã–≤–∞–µ–º –±–∞–ª–∞–Ω—Å
            appState.balance -= 1.5;
            appState.wager += 1.5;
            appState.isSpinning = true;
            document.getElementById('btn-spin-elite').disabled = true;
            updateGlobalUI();

            const track = document.getElementById('roulette-track');
            prepareRoulette(); // –û–±–Ω–æ–≤–ª—è–µ–º –ª–µ–Ω—Ç—É –ø–µ—Ä–µ–¥ —Å–ø–∏–Ω–æ–º

            // –û–ü–†–ï–î–ï–õ–Ø–ï–ú –ü–û–ë–ï–î–ò–¢–ï–õ–Ø (–ú–ê–¢–ï–ú–ê–¢–ò–ö–ê –®–ê–ù–°–û–í)
            const randomPoint = Math.random() * 100;
            let winner = ELITE_CASE_ITEMS[0];
            let currentSum = 0;

            for(const item of ELITE_CASE_ITEMS) {
                currentSum += item.chance;
                if(randomPoint <= currentSum) {
                    winner = item;
                    break;
                }
            }

            // –í—Å—Ç–∞–≤–ª—è–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –Ω–∞ 70-—é –ø–æ–∑–∏—Ü–∏—é (–∫—É–¥–∞ –ø—Ä–∏–µ–¥–µ—Ç —Ä—É–ª–µ—Ç–∫–∞)
            const cards = track.querySelectorAll('.case-item');
            const targetIndex = 70;
            const winningCard = createItemCard(winner);
            cards[targetIndex].replaceWith(winningCard);

            // –ó–ê–ü–£–°–ö –ê–ù–ò–ú–ê–¶–ò–ò
            // –®–∏—Ä–∏–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ 110 + margin 12 = 122px
            const cardFullWidth = 122;
            const trackContainerWidth = document.querySelector('.roulette-wrapper').offsetWidth;
            const centerOffset = (trackContainerWidth / 2) - (cardFullWidth / 2);
            const finalPosition = -(targetIndex * cardFullWidth) + centerOffset;

            setTimeout(() => {
                track.style.transition = 'transform 6s cubic-bezier(0.1, 0, 0, 1)';
                // –ù–µ–±–æ–ª—å—à–æ–π —Å–ª—É—á–∞–π–Ω—ã–π —Å–¥–≤–∏–≥ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
                const randomInnerOffset = (Math.random() * 60) - 30;
                track.style.transform = `translateX(${finalPosition + randomInnerOffset}px)`;
            }, 50);

            // –ó–ê–í–ï–†–®–ï–ù–ò–ï –°–ü–ò–ù–ê
            setTimeout(() => {
                appState.balance += winner.val;
                appState.isSpinning = false;
                document.getElementById('btn-spin-elite').disabled = false;
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
                const nextTarget = appState.level * 15;
                if(appState.wager >= nextTarget) {
                    appState.level++;
                    alert(`üéä –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ —É—Ä–æ–≤–Ω—è ${appState.level}!`);
                }
                
                updateGlobalUI();
                alert(`–í—ã–ø–∞–ª–æ: ${winner.name} (+${winner.val.toFixed(2)} TON)`);
            }, 6500);
        }

        /**
         * –ü–†–û–ß–ò–ï –§–£–ù–ö–¶–ò–ò
         */
        function handleJoinPVP() {
            const bet = parseFloat(document.getElementById('pvp-bet').value);
            if(bet > appState.balance) return alert("–ú–∞–ª–æ TON");
            appState.balance -= bet;
            appState.wager += bet;
            updateGlobalUI();
            alert("–°—Ç–∞–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞! –û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤...");
        }

        function systemReset() {
            if(confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å?")) {
                localStorage.clear();
                location.reload();
            }
        }

        function openChat() {
            alert("–ß–∞—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –í–µ–¥—É—Ç—Å—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã.");
        }
        
    </script>
</body>
</html>

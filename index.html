<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Crash TON FULL</title>

<style>
:root{
--bg:#07080a;--card:#121418;--blue:#0098ea;
--green:#0ecb81;--red:#f6465d;--gold:#f3ba2f;--sec:#707a8a
}
*{box-sizing:border-box;font-family:Arial}
body{margin:0;background:var(--bg);color:white;height:100vh;display:flex;flex-direction:column}
.header{display:flex;justify-content:space-between;padding:12px 16px}
.balance{background:#1e2329;padding:6px 14px;border-radius:50px;font-weight:900}
.game{position:relative;height:260px;border-bottom:1px solid #1a1d23}
canvas{position:absolute;inset:0}
.mult{position:absolute;width:100%;top:35%;text-align:center;font-size:64px;font-weight:900}
.count{position:absolute;width:100%;top:30%;text-align:center;font-size:90px;font-weight:900}
.history{position:absolute;top:10px;left:10px;display:flex;gap:6px}
.h{background:#1e2329;padding:4px 8px;border-radius:6px;font-size:12px}
.tabs{display:flex;background:var(--card);margin:12px;border-radius:12px;padding:4px}
.tab{flex:1;text-align:center;padding:10px;font-weight:900;color:var(--sec);cursor:pointer;border-radius:8px}
.tab.active{background:#1e2329;color:white}
.panel{padding:0 16px 16px;display:flex;flex-direction:column;gap:10px}
.row{display:flex;gap:10px}
.box{flex:1;background:#1c1f24;border-radius:12px;padding:10px}
.box label{font-size:10px;color:var(--sec);font-weight:800}
.box input{background:none;border:none;color:white;font-size:18px;font-weight:900;width:100%}
.btn{height:58px;border-radius:14px;border:none;font-size:18px;font-weight:900;background:var(--blue);color:white}
.btn.collect{background:var(--green)}
.btn:disabled{background:#1e2329;color:var(--sec)}
.list{flex:1;overflow:auto;padding:0 16px}
.card{background:var(--card);padding:12px;border-radius:14px;display:flex;justify-content:space-between;margin-bottom:8px}
.toast{position:fixed;top:20px;left:50%;transform:translateX(-50%) translateY(-100px);
background:#1c1f24;padding:14px 24px;border-radius:14px;border:1px solid var(--green);
transition:.4s;z-index:999}
.toast.show{transform:translateX(-50%) translateY(0)}
</style>
</head>

<body>

<div class="toast" id="toast"><b>+0 TON</b></div>

<div class="header">
<div>‚óè online</div>
<div class="balance">üíé <span id="bal">100.00</span></div>
</div>

<div class="game">
<div class="history" id="hist"></div>
<canvas id="cv"></canvas>
<div class="mult" id="mult">x1.00</div>
<div class="count" id="count">5</div>
</div>

<div class="tabs">
<div class="tab active" onclick="tab('bets')">–°–¢–ê–í–ö–ò</div>
<div class="tab" onclick="tab('top')">–¢–û–ü</div>
<div class="tab" onclick="tab('admin')">–ê–î–ú–ò–ù</div>
</div>

<div class="panel">
<div class="row">
<div class="box"><label>–°–£–ú–ú–ê</label><input id="sum" type="number" value="10"></div>
<div class="box"><label>–ê–í–¢–û</label><input id="auto" type="number" value="1.5"></div>
</div>
<button class="btn" id="btn" onclick="action()">–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>
</div>

<div class="list" id="list"></div>

<script>
/* ================= CORE ================= */
let balance=100,state="WAIT",x=1,bet=0,taken=false;
const user={id:1,name:"YOU",role:"admin",banned:false,last:[]};
const bans=[];
const leaders=[];
const toast=document.getElementById("toast");

/* ================= CANVAS ================= */
const cv=document.getElementById("cv"),ctx=cv.getContext("2d");
cv.width=innerWidth;cv.height=260;
const rocket=new Image();
rocket.src="https://cdn-icons-png.flaticon.com/512/1043/1043514.png";

/* ================= BOT ================= */
const BOT_ENABLED=true;
const bots=[
{name:"BOT_A",bal:9999},
{name:"BOT_B",bal:9999},
{name:"BOT_C",bal:9999}
];

/* ================= ANTIFRAUD ================= */
function antifraud(v){
const n=Date.now();
user.last.push(n);
user.last=user.last.filter(t=>n-t<4000);
if(user.last.length>5){ban(user.id);return false}
return true
}

/* ================= BAN ================= */
function ban(id){
bans.push(id);
alert("BAN");
location.reload();
}

/* ================= GAME ================= */
function start(){
state="WAIT";x=1;taken=false;
count.style.display="block";
mult.style.display="none";
btn.disabled=false;btn.textContent="–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É";
let t=5;
const timer=setInterval(()=>{
count.textContent=t--;
if(t<0){clearInterval(timer);fly()}
},1000);
}

function fly(){
state="FLY";
count.style.display="none";
mult.style.display="block";
if(bet>0){btn.textContent="–ó–∞–±—Ä–∞—Ç—å";btn.className="btn collect"}
const crash=(Math.random()*4+1.1).toFixed(2);
const auto=+document.getElementById("auto").value;

const loop=setInterval(()=>{
x+=x*0.012;
mult.textContent="x"+x.toFixed(2);
ctx.clearRect(0,0,cv.width,cv.height);
ctx.beginPath();
ctx.strokeStyle="#0ecb81";ctx.lineWidth=5;
ctx.moveTo(40,220);
ctx.quadraticCurveTo((x-1)*40,220,(x-1)*60,220-(x-1)*45);
ctx.stroke();
ctx.drawImage(rocket,(x-1)*60,220-(x-1)*45,40,40);

if(bet&&!taken&&x>=auto)collect();
if(x>=crash){clearInterval(loop);boom(crash)}
},60);

/* BOT ACTION */
if(BOT_ENABLED){
bots.forEach(b=>{
if(Math.random()>0.6)addBet(b.name,(Math.random()*2+1).toFixed(2))
});
}
}

function boom(v){
const h=document.createElement("div");
h.className="h";h.textContent=v;
hist.prepend(h);if(hist.children.length>6)hist.lastChild.remove();
setTimeout(start,2000);
}

function action(){
if(state==="WAIT"){
const s=+sum.value;
if(s<=0||s>balance||!antifraud(s))return;
balance-=s;bet=s;
update();
btn.disabled=true;btn.textContent="–ü—Ä–∏–Ω—è—Ç–æ";
}else if(state==="FLY"&&!taken){
collect();
}
}

function collect(){
taken=true;
const win=bet*x;
balance+=win;
toast.innerHTML="<b>+"+win.toFixed(2)+" TON</b>";
toast.classList.add("show");
setTimeout(()=>toast.classList.remove("show"),2000);
btn.disabled=true;btn.textContent="–ó–∞–±—Ä–∞–Ω–æ";
leaders.push({name:user.name,win});
update();
}

function update(){bal.textContent=balance.toFixed(2)}

/* ================= LISTS ================= */
function addBet(name,x){
const d=document.createElement("div");
d.className="card";
d.innerHTML=`<div>${name}</div><div>x${x}</div>`;
list.prepend(d);
}

/* ================= TABS ================= */
function tab(t){
document.querySelectorAll(".tab").forEach(e=>e.classList.remove("active"));
event.target.classList.add("active");
list.innerHTML="";
if(t==="bets"){addBet("BOT","1.45")}
if(t==="top"){
leaders.slice(-10).reverse().forEach(l=>{
list.innerHTML+=`<div class="card"><div>${l.name}</div><div style="color:var(--gold)">+${l.win.toFixed(2)}</div></div>`
})
}
if(t==="admin"){
list.innerHTML=`
<div class="card"><b>ADMIN</b></div>
<div class="card"><button onclick="ban(1)">BAN USER</button></div>
`;
}
}

/* ================= START ================= */
update();
start();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crash TON Premium</title>
    <style>
        :root {
            --bg: #0b0e11; --card: #181a20; --blue: #007bff;
            --green: #0ecb81; --red: #f6465d; --text-sec: #848e9c;
        }
        * { box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: white; margin: 0; overflow: hidden; display: flex; flex-direction: column; height: 100vh; }
        
        /* HEADER */
        .header { display: flex; justify-content: space-between; padding: 10px 16px; align-items: center; }
        .online { background: #1e2329; padding: 4px 12px; border-radius: 20px; color: var(--green); font-size: 13px; font-weight: 700; display: flex; align-items: center; gap: 6px; }
        .dot { width: 6px; height: 6px; background: var(--green); border-radius: 50%; }
        .balance-wrap { display: flex; align-items: center; gap: 8px; background: #1e2329; padding: 4px 4px 4px 12px; border-radius: 20px; }
        .add-btn { background: var(--blue); width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer; }

        /* GAME ZONE */
        .page { flex: 1; display: none; flex-direction: column; position: relative; overflow: hidden; }
        .page.active { display: flex; }
        
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .mult-display { position: absolute; top: 30%; width: 100%; text-align: center; font-size: 70px; font-weight: 900; z-index: 5; }
        .mult-display.crashed { color: var(--red); }
        .mult-display.waiting { color: var(--text-sec); font-size: 50px; }

        /* PROFILE UI */
        .profile-container { padding: 20px; text-align: center; }
        .avatar-big { width: 80px; height: 80px; background: var(--blue); border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 32px; font-weight: bold; }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .stat-card { background: var(--card); padding: 15px; border-radius: 12px; border: 1px solid #2b3139; }
        .stat-val { display: block; font-size: 18px; font-weight: 800; color: var(--blue); }
        .stat-label { font-size: 11px; color: var(--text-sec); text-transform: uppercase; }

        /* CONTROLS & LIST */
        .controls { padding: 16px; background: var(--bg); }
        .main-btn { width: 100%; height: 56px; border-radius: 12px; border: none; background: var(--blue); color: white; font-size: 18px; font-weight: 800; box-shadow: 0 4px 0 #0056b3; }
        .main-btn.collect { background: var(--green); box-shadow: 0 4px 0 #0a9d63; }
        
        .players-box { height: 180px; overflow-y: auto; padding: 0 16px; border-top: 1px solid #1e2329; }
        .p-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #1e2329; font-size: 14px; }

        /* NAV BAR */
        .nav { display: flex; justify-content: space-around; padding: 12px 0; background: #181a20; border-top: 1px solid #1e2329; }
        .nav-item { text-align: center; color: var(--text-sec); font-size: 11px; cursor: pointer; flex: 1; }
        .nav-item.active { color: var(--blue); font-weight: bold; }
    </style>
</head>
<body>

<div class="header">
    <div class="online"><div class="dot"></div> <span id="online-val">134</span></div>
    <div class="balance-wrap">
        <span id="bal-val">100.00</span>
        <div class="add-btn">+</div>
    </div>
</div>

<div id="game-page" class="page active">
    <canvas id="gameCanvas"></canvas>
    <div class="mult-display" id="mult">3</div>
    <div class="controls">
        <button class="main-btn" id="bet-btn">–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>
    </div>
    <div class="players-box" id="players"></div>
</div>

<div id="profile-page" class="page">
    <div class="profile-container">
        <div class="avatar-big">U</div>
        <h2>–ò–≥—Ä–æ–∫ #<span id="p-id">...</span></h2>
        <div class="stat-grid">
            <div class="stat-card"><span class="stat-val" id="st-games">0</span><span class="stat-label">–ò–≥—Ä</span></div>
            <div class="stat-card"><span class="stat-val" id="st-wins">0</span><span class="stat-label">–ü–æ–±–µ–¥</span></div>
            <div class="stat-card" style="grid-column: span 2;"><span class="stat-val" id="st-max">1.00x</span><span class="stat-label">–õ—É—á—à–∏–π –∏–∫—Å</span></div>
        </div>
        <button class="main-btn" style="margin-top: 30px; background: #2b3139; box-shadow: none;" onclick="resetData()">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë</button>
    </div>
</div>

<div class="nav">
    <div class="nav-item" onclick="showPage('game')">üèÜ<br>–¢–æ–ø</div>
    <div class="nav-item active" onclick="showPage('game')">üöÄ<br>–ö—Ä–∞—à</div>
    <div class="nav-item" onclick="showPage('profile')">üë§<br>–ü—Ä–æ—Ñ–∏–ª—å</div>
</div>

<script>
    // --- –î–ê–ù–ù–´–ï ---
    let data = JSON.parse(localStorage.getItem('crash_data')) || {
        bal: 100.00, games: 0, wins: 0, max: 1.0, id: Math.floor(1000 + Math.random()*9000)
    };

    function save() {
        localStorage.setItem('crash_data', JSON.stringify(data));
        document.getElementById('bal-val').innerText = data.bal.toFixed(2);
        document.getElementById('p-id').innerText = data.id;
        document.getElementById('st-games').innerText = data.games;
        document.getElementById('st-wins').innerText = data.wins;
        document.getElementById('st-max').innerText = data.max.toFixed(2) + 'x';
    }

    // --- –õ–û–ì–ò–ö–ê –ò–ì–†–´ ---
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const multText = document.getElementById('mult');
    const betBtn = document.getElementById('bet-btn');
    
    let isRunning = false;
    let currentMult = 1.00;
    let myBet = 0;

    function runCycle() {
        isRunning = false;
        let cd = 3;
        multText.className = 'mult-display waiting';
        const timer = setInterval(() => {
            multText.innerText = cd;
            cd--;
            if(cd < 0) { clearInterval(timer); startFly(); }
        }, 1000);
    }

    function startFly() {
        isRunning = true;
        multText.className = 'mult-display';
        let start = Date.now();
        let crashPoint = (Math.random() < 0.05) ? 1.00 : (0.98 / (1 - Math.random()) + 1).toFixed(2);

        if(myBet > 0) {
            betBtn.innerText = "–í—ã–≤–µ—Å—Ç–∏";
            betBtn.classList.add('collect');
            data.games++;
            save();
        }

        const loop = setInterval(() => {
            let elapsed = (Date.now() - start) / 1000;
            currentMult = Math.pow(Math.E, 0.08 * elapsed);
            multText.innerText = currentMult.toFixed(2) + "x";
            draw(elapsed);

            if(currentMult >= crashPoint) {
                clearInterval(loop);
                crash(crashPoint);
            }
        }, 50);
    }

    function draw(t) {
        canvas.width = canvas.offsetWidth; canvas.height = canvas.offsetHeight;
        ctx.clearRect(0,0,canvas.width, canvas.height);
        ctx.beginPath(); ctx.strokeStyle = '#007bff'; ctx.lineWidth = 4;
        ctx.moveTo(0, canvas.height);
        let x = Math.min(canvas.width * 0.8, t * 50);
        let y = canvas.height - Math.min(canvas.height * 0.8, Math.pow(t, 1.8) * 10);
        ctx.quadraticCurveTo(canvas.width * 0.2, canvas.height, x, y);
        ctx.stroke();
        ctx.font = "30px Arial"; ctx.fillText("üöÄ", x - 15, y - 5);
    }

    function crash(p) {
        isRunning = false;
        multText.innerText = p + "x";
        multText.classList.add('crashed');
        betBtn.innerText = "–°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É";
        betBtn.classList.remove('collect');
        betBtn.disabled = false;
        myBet = 0;
        setTimeout(runCycle, 3000);
    }

    betBtn.onclick = () => {
        if(!isRunning && myBet === 0) {
            if(data.bal >= 10) {
                myBet = 10; data.bal -= 10;
                betBtn.innerText = "–°—Ç–∞–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞";
                betBtn.disabled = true;
                save();
            }
        } else if(isRunning && myBet > 0) {
            let win = myBet * currentMult;
            data.bal += win; data.wins++;
            if(currentMult > data.max) data.max = currentMult;
            myBet = 0;
            betBtn.innerText = "+" + win.toFixed(2);
            betBtn.disabled = true;
            save();
        }
    };

    // --- –ù–ê–í–ò–ì–ê–¶–ò–Ø ---
    function showPage(p) {
        document.querySelectorAll('.page').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        document.getElementById(p + '-page').classList.add('active');
        event.currentTarget.classList.add('active');
    }

    function resetData() {
        if(confirm("–°–±—Ä–æ—Å–∏—Ç—å –±–∞–ª–∞–Ω—Å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É?")) {
            localStorage.clear(); location.reload();
        }
    }

    save(); runCycle();
</script>
</body>
</html>
